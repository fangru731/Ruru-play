<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🌟 Ruru 陪玩寶貝單 🌟</title>
  <style>
    body { background-image: url('star-bg-demo.jpg'); background-size: cover; background-attachment: fixed; font-family: 'Microsoft JhengHei', Arial, sans-serif; color: #333; margin: 0; padding: 0;}
    .container { background: rgba(255,255,255,0.97); max-width: 820px; margin: 40px auto 22px auto; padding: 32px 18px 18px 18px; border-radius: 28px; box-shadow: 0 0 28px #fae89d; position: relative;}
    .title-header { text-align:center; margin-bottom:22px; position:relative;}
    .minions-row { display:flex; justify-content:center; gap:26px; margin-bottom:10px;}
    .minions-row.bottom { margin-top:15px; margin-bottom:0;}
    .minions-row img { width:88px; height:88px;}
    .title-row { display: flex; align-items: center; justify-content: center; gap: 38px; margin-bottom: 0;}
    .q-ruru-inline { width: 152px; border-radius: 20px; box-shadow: 0 0 10px #ffe082b0; background: #fff;}
    h1 { flex: 0 1 auto; color: #ffb300; margin: 0 0 0 0; font-size: 2.5em; letter-spacing: 2px; text-align: center; font-weight: bold; text-shadow: 0 2px 8px #fff9cd;}
    .form-section { margin-bottom:22px;}
    label { font-weight: bold; margin-top: 18px; display: block; color: #333; font-size: 1.11em;}
    input[type="text"], input[type="number"], select { width: 95%; padding: 10px; border: 1.9px solid #ffde89; border-radius: 10px; margin-bottom: 8px; margin-top: 4px; font-size: 1.09em; box-sizing: border-box;}
    input[type="file"] { margin: 8px 0 16px 0;}
    .checkbox-label { font-weight: normal; margin-left: 4px;}
    .order-summary { background: #fff7e0; padding: 20px; border-radius: 18px; margin: 27px 0 15px 0; font-size: 1.15em; box-shadow: 0 0 12px #ffe08265;}
    .footer { margin-top: 22px; text-align: center; color: #666; font-size: 1.07em;}
    .qr { display:block; margin:22px auto 7px auto; width:105px; border-radius:16px; box-shadow:0 0 9px #ffef8f55;}
    button, .btn { background: #ffd43b; color:#a67200; font-size: 1.22em; border:none; border-radius:12px; padding:13px 32px; cursor:pointer; margin-top:13px; box-shadow:0 2px 12px #ffe08270; transition:0.1s; font-weight:bold;}
    button:hover { background: #fff176; color: #e67a00;}
    .agree-label { font-weight: normal; color:#c18700; }
    @media (max-width: 800px) { .container { max-width: 99vw; padding: 3vw 1.5vw;} .q-ruru-inline { width:90px;} .minions-row img { width:50px; height:50px;} .qr { width:54px; } h1 { font-size: 1.35em; } }
  </style>
</head>
<body>
  <div class="container">
    <!-- 標題與裝飾 -->
    <div class="title-header">
      <div class="minions-row"><img src="minion-1.png"><img src="minion-2.png"><img src="minion-3.png"></div>
      <div class="title-row"><h1>🌟 Ruru 陪玩寶貝單 🌟</h1><img src="q-ruru-demo.png" class="q-ruru-inline"></div>
      <div class="minions-row bottom"><img src="minion-4.png"><img src="minion-5.png"><img src="minion-6.png"></div>
    </div>
    <!-- 表單本體 -->
    <form id="orderForm" autocomplete="off">
      <div class="form-section">
        <label for="nickname">暱稱（必填）</label>
        <input type="text" id="nickname" maxlength="12" required placeholder="請填你的暱稱">
      </div>
      <div class="form-section">
        <label>陪玩項目（可複選＋填單數）</label>
        <div>
          <input type="number" id="s1" min="0" max="99" value="0" style="width:64px;"> <span class="checkbox-label">傳說對決（$200/兩場）

沒問題，這裡是**分開星期+時段的完整版前端表單程式碼**，包含你所有需求（自動計算金額、買五送二、贈送欄位、上傳匯款/折扣圖、賴Pay互動、完整訂單摘要等）。你只要**直接複製貼上**，把 Apps Script 部署網址換成你的就能直接用。

---

## 🌟 Ruru 陪玩分開星期與時段表單（HTML+JS 完整版）

```html
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🌟 Ruru 陪玩寶貝單 🌟</title>
  <style>
    body { background-image: url('star-bg-demo.jpg'); background-size: cover; background-attachment: fixed; font-family: 'Microsoft JhengHei', Arial, sans-serif; color: #333; margin: 0; padding: 0;}
    .container { background: rgba(255,255,255,0.97); max-width: 820px; margin: 40px auto 22px auto; padding: 32px 18px 18px 18px; border-radius: 28px; box-shadow: 0 0 28px #fae89d; position: relative;}
    .title-header { text-align:center; margin-bottom:22px; position:relative;}
    .minions-row { display:flex; justify-content:center; gap:26px; margin-bottom:10px;}
    .minions-row.bottom { margin-top:15px; margin-bottom:0;}
    .minions-row img { width:88px; height:88px;}
    .title-row { display: flex; align-items: center; justify-content: center; gap: 38px; margin-bottom: 0;}
    .q-ruru-inline { width: 152px; border-radius: 20px; box-shadow: 0 0 10px #ffe082b0; background: #fff;}
    h1 { flex: 0 1 auto; color: #ffb300; margin: 0 0 0 0; font-size: 2.5em; letter-spacing: 2px; text-align: center; font-weight: bold; text-shadow: 0 2px 8px #fff9cd;}
    .form-section { margin-bottom:22px;}
    label { font-weight: bold; margin-top: 18px; display: block; color: #333; font-size: 1.11em;}
    input[type="text"], input[type="number"], select { width: 95%; padding: 10px; border: 1.9px solid #ffde89; border-radius: 10px; margin-bottom: 8px; margin-top: 4px; font-size: 1.09em; box-sizing: border-box;}
    input[type="file"] { margin: 8px 0 16px 0;}
    .checkbox-label { font-weight: normal; margin-left: 4px;}
    .order-summary { background: #fff7e0; padding: 20px; border-radius: 18px; margin: 27px 0 15px 0; font-size: 1.15em; box-shadow: 0 0 12px #ffe08265;}
    .footer { margin-top: 22px; text-align: center; color: #666; font-size: 1.07em;}
    .qr { display:block; margin:22px auto 7px auto; width:105px; border-radius:16px; box-shadow:0 0 9px #ffef8f55;}
    button, .btn { background: #ffd43b; color:#a67200; font-size: 1.22em; border:none; border-radius:12px; padding:13px 32px; cursor:pointer; margin-top:13px; box-shadow:0 2px 12px #ffe08270; transition:0.1s; font-weight:bold;}
    button:hover { background: #fff176; color: #e67a00;}
    .agree-label { font-weight: normal; color:#c18700; }
    @media (max-width: 800px) { .container { max-width: 99vw; padding: 3vw 1.5vw;} .q-ruru-inline { width:90px;} .minions-row img { width:50px; height:50px;} .qr { width:54px; } h1 { font-size: 1.35em; } }
  </style>
</head>
<body>
  <div class="container">
    <!-- 標題與裝飾 -->
    <div class="title-header">
      <div class="minions-row"><img src="minion-1.png"><img src="minion-2.png"><img src="minion-3.png"></div>
      <div class="title-row"><h1>🌟 Ruru 陪玩寶貝單 🌟</h1><img src="q-ruru-demo.png" class="q-ruru-inline"></div>
      <div class="minions-row bottom"><img src="minion-4.png"><img src="minion-5.png"><img src="minion-6.png"></div>
    </div>
    <!-- 表單本體 -->
    <form id="orderForm" autocomplete="off">
      <div class="form-section">
        <label for="nickname">暱稱（必填）</label>
        <input type="text" id="nickname" maxlength="12" required placeholder="請填你的暱稱">
      </div>
      <div class="form-section">
        <label>陪玩項目（可複選＋填單數）</label>
        <div>
          <input type="number" id="s1" min="0" max="99" value="0" style="width:64px;"> <span class="checkbox-label">傳說對決（$200/兩場）</span><br>
          <input type="number" id="s2" min="0" max="99" value="0" style="width:64px;"> <span class="checkbox-label">語音通話（$250/30分）</span><br>
          <input type="number" id="s3" min="0" max="99" value="0" style="width:64px;"> <span class="checkbox-label">打字聊天（$200/30分）</span><br>
          <input type="number" id="s4" min="0" max="99" value="0" style="width:64px;"> <span class="checkbox-label">全民Party 唱歌（$100/首）</span><br>
          <input type="number" id="s5" min="0" max="99" value="0" style="width:64px;"> <span class="checkbox-label">情感諮詢（$200/30分）</span><br>
          <input type="checkbox" id="donateCheck" onchange="document.getElementById('donateAmt').style.display=this.checked?'inline':'none';document.getElementById('donateMsg').style.display=this.checked?'block':'none';"> <span class="checkbox-label">贊助支持（抖內）</span>
          <input type="number" id="donateAmt" min="0" max="99999" value="0" style="width:100px; display:none;" placeholder="自填金額">
          <input type="text" id="donateMsg" style="width:220px; display:none;" maxlength="32" placeholder="給Ru的話">
        </div>
      </div>
      <div class="form-section">
        <label>付款方式（必選）</label>
        <select id="payType" required onchange="onPayTypeChange()">
          <option value="">請選擇</option>
          <option value="linepay">Line Pay</option>
          <option value="bank">匯款轉帳</option>
        </select>
      </div>
      <div id="bankInfo" style="display:none; background:#fffde5; border:1.2px solid #ffe082; border-radius:10px; padding:11px 16px 11px 16px; color:#a36b00; margin-bottom:10px; font-size:1em;">
        <b>匯款資訊：</b><br>
        LINE Bank 銀行帳戶：824 連線商業銀行<br>
        帳號：111019874455<br>
        戶名：林芳如<br>
        匯款備註請填寫「小如＋項目＋金額」以利對帳<br>
      </div>
      <div id="payRemark" style="display:none; color:#b86d00; font-size:1em; margin-bottom:12px;">
        請暫勿付款，等 Ru 回覆 Line Pay 帳號再付款哦！
      </div>
      <div class="form-section">
        <label>折扣金</label>
        <select id="discount" onchange="toggleDiscountProof()">
          <option value="0">不使用折扣</option>
          <option value="50">分享折扣 $50</option>
          <option value="30">推薦好友折扣 $30</option>
          <option value="30">追蹤 IG 折扣 $30</option>
        </select>
        <input type="file" id="discountProof" accept="image/*,.jpg,.jpeg,.png" style="margin-top:7px;display:none;">
        <label id="discountProofLabel" style="margin-bottom:0; color:#bb8600; display:none;">請上傳折扣金截圖證明</label>
      </div>
      <div class="form-section">
        <label>上傳匯款／付款／折扣截圖（如有）</label>
        <input type="file" id="proofFile" accept="image/*,.jpg,.jpeg,.png" multiple>
      </div>
      <!-- 分開星期＋時段 -->
      <div class="form-section">
        <label>預約星期</label>
        <select id="weekday" required></select>
        <label>預約時段</label>
        <select id="timeblock" required>
          <option value="">請先選星期</option>
        </select>
      </div>
      <!-- 規則 -->
      <div class="form-section" style="margin-bottom: 8px;">
        <div style="max-height:210px; overflow-y:auto; border:1.2px solid #ffe082; background:#fffdf5; border-radius:9px; padding:10px; font-size:1em; color:#a36b00;">
          <b>《Ru 的陪玩注意事項與服務規則》🌹</b><br>
          📌 下單前請務必詳閱，保障彼此權益與互動品質。<br>
          <b>🧡 一、服務本質與互動原則</b><br>
          本服務為純線上「語音／文字聊天、陪唱、陪玩遊戲」等陪伴互動…<br>
          <b>💳 二、付款與預約須知</b><br>
          須先完成付款（Line Pay／匯款）…<br>
          <b>🕒 三、排程與時間說明</b><br>
          若同時段預約人數多…<br>
          <b>🛡️ 四、禁止行為與黑單制度</b><br>
          嚴禁以下違規行為…<br>
          <b>📢 五、社群與 IG 規範</b><br>
          歡迎追蹤 IG：@fangru_0731…<br>
          <b>🔐 六、隱私保護與公開限制</b><br>
          所有語音、文字、圖片內容皆屬私人互動…<br>
          <b>🚫 七、優惠與黑名單規則</b><br>
          優惠券與活動不得重複使用…<br>
          <b>🌸 八、溫柔結語</b><br>
          我是 Ru，致力於打造一個溫柔、安全、界線清楚的陪伴空間…<br>
          <br>
          <b style="color:#c22;">📌 ⟪下單即表示您已閱讀並完全同意上述所有服務條款，違反規則恕不退款也不再提供服務⟫</b>
        </div>
        <label class="agree-label"><input type="checkbox" id="agreeRule" required> 我已詳細閱讀並同意上述《Ru 的陪玩注意事項與服務規則》（必須勾選）</label>
      </div>
      <div class="form-section" style="text-align:center;">
        <button type="button" onclick="calcAll()">計算應付金額</button>
        <button type="submit" class="btn">完成預約並送出</button>
      </div>
    </form>
    <!-- 訂單總覽 -->
    <div class="order-summary" id="summaryBox">
      <b>預約時間：</b><span id="showTime"></span><br>
      <b>所選項目：</b><span id="showItems"></span><br>
      <b>服務金額小計：</b><span id="subtotalTxt">0</span> 元<br>
      <b>折扣金額：</b><span id="discountTxt">0</span> 元<br>
      <b>贊助金額：</b><span id="donateTxt">0</span> 元<br>
      <b>最終應付金額：</b><span id="total">0</span> 元
    </div>
    <!-- 買五送二自動顯示 -->
    <div class="order-summary" id="bonusSection" style="background:#fffbe0; display:none;"></div>
    <!-- LINE QR code -->
    <img src="ru-line-qr-demo.png" class="qr" alt="Line QR Code">
    <div class="footer">加我官方 LINE 聯繫喔！</div>
  </div>
  <!-- JS 區塊 -->
  <script>
    // ====== 1. 本週分天時段，可每週修改 ======
    const timeMap = {
      "星期二": [ "00:00","00:30","01:00","01:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30" ],
      "星期三": [ "23:00","23:30","00:00","00:30","01:00","01:30" ],
      "星期四": [ "19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30","00:00","00:30" ],
      "星期五": [ "23:00","23:30","00:00","00:30" ],
      "星期六": [ "19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30","00:00","00:30","01:00","01:30" ],
      "星期日": [ "00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30","04:00","04:30","05:00","05:30",
        "06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30",
        "13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30",
        "20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"
      ]
    };
    // 已被預約/過去的時段可額外加陣列: 例如 ["星期四|20:30", ...]
    const reservedTimes = []; // 例 ["星期四|20:30"]
    // 填入星期
    window.onload = function() {
      let weekdaySel = document.getElementById('weekday');
      weekdaySel.innerHTML = '<option value="">請選擇星期</option>';
      Object.keys(timeMap).forEach(weekday => {
        let opt = document.createElement('option');
        opt.value = weekday;
        opt.innerText = weekday;
        weekdaySel.appendChild(opt);
      });
      document.getElementById('timeblock').innerHTML = '<option value="">請先選星期</option>';
    };
    document.getElementById('weekday').onchange = function() {
      let val = this.value, sel = document.getElementById('timeblock');
      sel.innerHTML = '<option value="">請選擇時段</option>';
      if (!timeMap[val]) return;
      let now = new Date();
      let today = ["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][now.getDay()];
      timeMap[val].forEach(time => {
        // 時間過濾（可依需求自訂規則，這裡不會自動過濾今天以前）
        let disable = reservedTimes.includes(val+"|"+time);
        let label = time + (disable ? "（已被預約或已過）" : "");
        let opt = document.createElement('option');
        opt.value = time;
        opt.innerText = label;
        if (disable) opt.disabled = true;
        sel.appendChild(opt);
      });
    };
    // 折扣金
    function toggleDiscountProof() {
      const discount = document.getElementById('discount').value;
      const proof = document.getElementById('discountProof');
      const label = document.getElementById('discountProofLabel');
      if (discount === "0") { proof.style.display = "none"; label.style.display = "none"; }
      else { proof.style.display = "block"; label.style.display = "block"; }
    }
    // 賴Pay提示
    function onPayTypeChange() {
      const payType = document.getElementById('payType').value;
      document.getElementById('bankInfo').style.display = (payType==="bank") ? "" : "none";
      document.getElementById('payRemark').style.display = (payType==="linepay") ? "" : "none";
    }
    // 自動金額＋摘要
    function calcAll() {
      let price = [200,250,200,100,200];
      let items = [], subtotal = 0, singles = 0;
      for(let i=1;i<=5;i++){
        let v = parseInt(document.getElementById('s'+i).value)||0;
        if(v>0){ items.push(['傳說對決','語音通話','打字聊天','全民Party 唱歌','情感諮詢'][i-1]+' x'+v); subtotal += v*price[i-1]; singles += v;}
      }
      document.getElementById('showItems').innerText = items.join('、')||'無';
      document.getElementById('subtotalTxt').innerText = subtotal;
      let discount = parseInt(document.getElementById('discount').value)||0;
      document.getElementById('discountTxt').innerText = discount;
      let donate = document.getElementById('donateCheck').checked ? (parseInt(document.getElementById('donateAmt').value)||0) : 0;
      document.getElementById('donateTxt').innerText = donate;
      let total = subtotal - discount + donate;
      document.getElementById('total').innerText = total<0?0:total;
      let weekday = document.getElementById('weekday').value;
      let time = document.getElementById('timeblock').value;
      document.getElementById('showTime').innerText = (weekday && time) ? `${weekday} ${time}` : "";
      // 買五送二
      let bonus = document.getElementById('bonusSection');
      let bonusCount = Math.floor(singles / 5) * 2;
      if (bonusCount > 0) {
        let selectHTML = '';
        for (let i = 1; i <= bonusCount; i++) {
          selectHTML +=
            `<select id="bonus${i}" style="margin-right:9px;margin-top:7px;">
              <option value="">請選擇贈送項目</option>
              <option value="s1">傳說對決</option>
              <option value="s2">語音通話</option>
              <option value="s3">打字聊天</option>
              <option value="s4">全民Party 唱歌</option>
              <option value="s5">情感諮詢</option>
            </select>`;
        }
        bonus.style.display = '';
        bonus.innerHTML = `🎁 已達買${Math.floor(singles/5)*5}送${bonusCount}優惠！請選擇贈送的服務：<br>${selectHTML}`;
      } else { bonus.style.display = 'none'; }
    }
    document.getElementById("orderForm").onsubmit = function(event){
      event.preventDefault();
      if (!document.getElementById("agreeRule").checked) {
        alert("請勾選同意服務規則！");
        return;
      }
      let singles = 0;
      for(let i=1;i<=5;i++){
        singles += parseInt(document.getElementById('s'+i).value)||0;
      }
      // collect bonus selected values
      let bonusVals = [];
      let bonusCount = Math.floor(singles / 5) * 2;
      for (let i = 1; i <= bonusCount; i++) {
        let sel = document.getElementById(`bonus${i}`);
        if (sel && sel.value) bonusVals.push(sel.value);
      }
      let formData = {
        nickname: document.getElementById('nickname').value,
        payType: document.getElementById('payType').value,
        weekday: document.getElementById('weekday').value,
        time: document.getElementById('timeblock').value,
        items: document.getElementById('showItems').innerText,
        subtotal: document.getElementById('subtotalTxt').innerText,
        discount: document.getElementById('discountTxt').innerText,
        donate: document.getElementById('donateTxt').innerText,
        bonus: bonusVals.join(','),
        donateMsg: document.getElementById('donateMsg') ? document.getElementById('donateMsg').value : ""
      };
      fetch("https://script.google.com/macros/s/AKfycbwpn7y3UJyDlVyFH0pPakvih4fnhBg1sVTBubkR_bp889PiN2vnUgFSlAP1n2Hx52yU/exec", {
        method: "POST",
        body: JSON.stringify(formData),
        headers: { "Content-Type": "application/json" }
      }).then(r=>r.text()).then(res=>{
        if(res.indexOf("success")>=0){
          alert('預約成功！Ru 已收到你的預約表單～');
          document.getElementById('orderForm').reset();
          calcAll();
        }else if(res.indexOf("黑名單")>=0){
          alert("你已被加入黑名單，無法預約！");
        }else{
          alert('此時段已被預約，請重新選擇！');
        }
      }).catch(e=>{
        alert('送出失敗，請聯絡Ru！');
      });
    };
  </script>
</body>
</html>
