<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸŒŸ Ruru é™ªç©å¯¶è²å–® ğŸŒŸ</title>
  <style>
    body {
      background-image: url('star-bg-demo.jpg');
      background-size: cover;
      background-attachment: fixed;
      font-family: 'Microsoft JhengHei', Arial, sans-serif;
      color: #333;
      margin: 0;
      padding: 0;
    }
    .container {
      background: rgba(255,255,255,0.97);
      max-width: 800px;
      margin: 40px auto 22px auto;
      padding: 32px 18px 18px 18px;
      border-radius: 22px;
      box-shadow: 0 0 22px #fae89d;
      position: relative;
    }
    .title-header { text-align:center; margin-bottom:18px; position:relative; }
    .minions-row { display:flex; justify-content:center; gap:13px; margin-bottom:5px; }
    .minions-row.bottom { margin-top:9px; margin-bottom:0; }
    .minions-row img { width:36px; height:36px; }
    .title-row {
      display: flex; align-items: center; justify-content: center;
      gap: 18px; margin-bottom: 0;
    }
    .q-ruru-inline {
      width: 60px; border-radius: 13px;
      box-shadow: 0 0 7px #ffe082b0;
      background: #fff;
    }
    h1 {
      flex: 0 1 auto;
      color: #ffb300;
      margin: 0 0 0 0;
      font-size: 2em;
      letter-spacing: 1.5px;
      text-align: center;
    }
    .form-section { margin-bottom:17px; }
    label { font-weight: bold; margin-top: 14px; display: block; color: #333; }
    input[type="text"], input[type="number"], select {
      width: 94%; padding: 7px; border: 1.5px solid #ffde89;
      border-radius: 8px; margin-bottom: 6px; margin-top: 4px; font-size: 1.07em; box-sizing: border-box;
    }
    input[type="file"] { margin: 6px 0 14px 0;}
    .checkbox-label { font-weight: normal; margin-left: 4px;}
    .order-summary {
      background: #fff7e0; padding: 16px; border-radius: 14px; margin: 21px 0 13px 0; font-size: 1.07em;
      box-shadow: 0 0 8px #ffe08255;
    }
    .notice {
      background: #fdf6e4; border-radius: 12px; padding: 13px; font-size: 1em; color: #b86d00; margin-bottom: 16px;
      border: 1.5px solid #ffe082;
    }
    .footer {
      margin-top: 19px; text-align: center; color: #666; font-size: 1em;
    }
    .qr { display:block; margin:18px auto 7px auto; width:90px; border-radius:13px; box-shadow:0 0 7px #ffef8f44;}
    button, .btn {
      background: #ffd43b; color:#a67200; font-size: 1.1em; border:none; border-radius:10px; padding:9px 22px; cursor:pointer;
      margin-top:9px; box-shadow:0 2px 8px #ffe08259; transition:0.1s;
    }
    button:hover { background: #fff176; color: #e67a00;}
    .agree-label { font-weight: normal; color:#c18700; }
    /* æ‰‹æ©Ÿ */
    @media (max-width: 700px) {
      .container { max-width: 99vw; padding: 4vw 2vw;}
      .q-ruru-inline { width:44px;}
      .minions-row img { width:22px; height:22px;}
      .qr { width:54px; }
      h1 { font-size: 1.2em; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ==== æ¨™é¡Œ+é ­è²¼+ä¸Šä¸‰ä¸‹ä¸‰å°å°å…µ ==== -->
    <div class="title-header">
      <div class="minions-row">
        <img src="minion-1.png" alt="å°å°å…µ1">
        <img src="minion-2.png" alt="å°å°å…µ2">
        <img src="minion-3.png" alt="å°å°å…µ3">
      </div>
      <div class="title-row">
        <h1>ğŸŒŸ Ruru é™ªç©å¯¶è²å–® ğŸŒŸ</h1>
        <img src="q-ruru-demo.png" class="q-ruru-inline" alt="Qç‰ˆRuru">
      </div>
      <div class="minions-row bottom">
        <img src="minion-4.png" alt="å°å°å…µ4">
        <img src="minion-5.png" alt="å°å°å…µ5">
        <img src="minion-6.png" alt="å°å°å…µ6">
      </div>
    </div>

    <!-- ==== è¡¨å–®é–‹å§‹ ==== -->
    <form id="orderForm" autocomplete="off">
      <div class="form-section">
        <label for="nickname">æš±ç¨±ï¼ˆå¿…å¡«ï¼‰</label>
        <input type="text" id="nickname" maxlength="12" required placeholder="è«‹å¡«ä½ çš„æš±ç¨±">
      </div>
      <div class="form-section">
        <label>é™ªç©é …ç›®ï¼ˆå¯è¤‡é¸ï¼‹å¡«å–®æ•¸ï¼‰</label>
        <div>
          <input type="number" id="s1" min="0" max="99" value="0" style="width:48px;"> <span class="checkbox-label">å‚³èªªå°æ±ºï¼ˆ$200/å…©å ´ï¼‰</span><br>
          <input type="number" id="s2" min="0" max="99" value="0" style="width:48px;"> <span class="checkbox-label">èªéŸ³é€šè©±ï¼ˆ$250/30åˆ†ï¼‰</span><br>
          <input type="number" id="s3" min="0" max="99" value="0" style="width:48px;"> <span class="checkbox-label">æ‰“å­—èŠå¤©ï¼ˆ$200/30åˆ†ï¼‰</span><br>
          <input type="number" id="s4" min="0" max="99" value="0" style="width:48px;"> <span class="checkbox-label">å…¨æ°‘Party å”±æ­Œï¼ˆ$100/é¦–ï¼‰</span><br>
          <input type="number" id="s5" min="0" max="99" value="0" style="width:48px;"> <span class="checkbox-label">æƒ…æ„Ÿè«®è©¢ï¼ˆ$200/30åˆ†ï¼‰</span><br>
          <input type="checkbox" id="donateCheck" onchange="document.getElementById('donateAmt').style.display=this.checked?'inline':'none';document.getElementById('donateMsg').style.display=this.checked?'block':'none';"> <span class="checkbox-label">è´ŠåŠ©æ”¯æŒï¼ˆæŠ–å…§ï¼‰</span>
          <input type="number" id="donateAmt" min="0" max="99999" value="0" style="width:80px; display:none;" placeholder="è‡ªå¡«é‡‘é¡">
          <input type="text" id="donateMsg" style="width:180px; display:none;" maxlength="32" placeholder="çµ¦Ruçš„è©±">
        </div>
      </div>
      <div class="form-section">
        <label>ä»˜æ¬¾æ–¹å¼ï¼ˆå¿…é¸ï¼‰</label>
        <select id="payType" required onchange="onPayTypeChange()">
          <option value="">è«‹é¸æ“‡</option>
          <option value="linepay">Line Pay</option>
          <option value="bank">åŒ¯æ¬¾è½‰å¸³</option>
        </select>
      </div>
      <!-- åŒ¯æ¬¾è³‡è¨Šå€å¡Š -->
      <div id="bankInfo" style="display:none; background:#fffde5; border:1.2px solid #ffe082; border-radius:10px; padding:11px 16px 11px 16px; color:#a36b00; margin-bottom:10px; font-size:1em;">
        <b>åŒ¯æ¬¾è³‡è¨Šï¼š</b><br>
        LINE Bank éŠ€è¡Œå¸³æˆ¶ï¼š824 é€£ç·šå•†æ¥­éŠ€è¡Œ<br>
        å¸³è™Ÿï¼š111019874455<br>
        æˆ¶åï¼šæ—èŠ³å¦‚<br>
        åŒ¯æ¬¾å‚™è¨»è«‹å¡«å¯«ã€Œå°å¦‚ï¼‹é …ç›®ï¼‹é‡‘é¡ã€ä»¥åˆ©å°å¸³<br>
      </div>
      <div id="payRemark" style="display:none; color:#b86d00; font-size:1em; margin-bottom:12px;">
        è«‹æš«å‹¿ä»˜æ¬¾ï¼Œç­‰ Ru å›è¦† Line Pay å¸³è™Ÿå†ä»˜æ¬¾å“¦ï¼
      </div>
      <div class="form-section">
        <label>æŠ˜æ‰£é‡‘</label>
        <select id="discount" onchange="toggleDiscountProof()">
          <option value="0">ä¸ä½¿ç”¨æŠ˜æ‰£</option>
          <option value="50">åˆ†äº«æŠ˜æ‰£ $50</option>
          <option value="30">æ¨è–¦å¥½å‹æŠ˜æ‰£ $30</option>
          <option value="30">è¿½è¹¤ IG æŠ˜æ‰£ $30</option>
        </select>
        <input type="file" id="discountProof" accept="image/*,.jpg,.jpeg,.png" style="margin-top:7px;display:none;">
        <label id="discountProofLabel" style="margin-bottom:0; color:#bb8600; display:none;">è«‹ä¸Šå‚³æŠ˜æ‰£é‡‘æˆªåœ–è­‰æ˜</label>
      </div>
      <div class="form-section">
        <label>ä¸Šå‚³åŒ¯æ¬¾ï¼ä»˜æ¬¾ï¼æŠ˜æ‰£æˆªåœ–ï¼ˆå¦‚æœ‰ï¼‰</label>
        <input type="file" id="proofFile" accept="image/*,.jpg,.jpeg,.png">
      </div>
      <div class="form-section">
        <label>é ç´„æ™‚é–“</label>
        <select id="weekday" onchange="updateTimeblocks()" required>
          <option value="">è«‹é¸æ“‡æ˜ŸæœŸ</option>
          <option value="2">æ˜ŸæœŸäºŒ</option>
          <option value="3">æ˜ŸæœŸä¸‰</option>
          <option value="4">æ˜ŸæœŸå››</option>
          <option value="5">æ˜ŸæœŸäº”</option>
          <option value="6">æ˜ŸæœŸå…­</option>
          <option value="7">æ˜ŸæœŸæ—¥</option>
        </select>
        <select id="timeblock" required>
          <option value="">è«‹å…ˆé¸æ˜ŸæœŸ</option>
        </select>
      </div>
      <!-- è¦å‰‡å‹¾é¸ -->
      <div class="form-section" style="margin-bottom: 8px;">
        <div style="max-height:210px; overflow-y:auto; border:1.2px solid #ffe082; background:#fffdf5; border-radius:9px; padding:10px; font-size:0.96em; color:#a36b00;">
          <b>ã€ŠRu çš„é™ªç©æ³¨æ„äº‹é …èˆ‡æœå‹™è¦å‰‡ã€‹ğŸŒ¹</b><br>
          ğŸ“Œ ä¸‹å–®å‰è«‹å‹™å¿…è©³é–±ï¼Œä¿éšœå½¼æ­¤æ¬Šç›Šèˆ‡äº’å‹•å“è³ªã€‚<br>
          <b>ğŸ§¡ ä¸€ã€æœå‹™æœ¬è³ªèˆ‡äº’å‹•åŸå‰‡</b><br>
          æœ¬æœå‹™ç‚ºç´”ç·šä¸Šã€ŒèªéŸ³ï¼æ–‡å­—èŠå¤©ã€é™ªå”±ã€é™ªç©éŠæˆ²ã€ç­‰é™ªä¼´äº’å‹•â€¦<br>
          <b>ğŸ’³ äºŒã€ä»˜æ¬¾èˆ‡é ç´„é ˆçŸ¥</b><br>
          é ˆå…ˆå®Œæˆä»˜æ¬¾ï¼ˆLine Payï¼åŒ¯æ¬¾ï¼‰â€¦<br>
          <b>ğŸ•’ ä¸‰ã€æ’ç¨‹èˆ‡æ™‚é–“èªªæ˜</b><br>
          è‹¥åŒæ™‚æ®µé ç´„äººæ•¸å¤šâ€¦<br>
          <b>ğŸ›¡ï¸ å››ã€ç¦æ­¢è¡Œç‚ºèˆ‡é»‘å–®åˆ¶åº¦</b><br>
          åš´ç¦ä»¥ä¸‹é•è¦è¡Œç‚ºâ€¦<br>
          <b>ğŸ“¢ äº”ã€ç¤¾ç¾¤èˆ‡ IG è¦ç¯„</b><br>
          æ­¡è¿è¿½è¹¤ IGï¼š@fangru_0731â€¦<br>
          <b>ğŸ” å…­ã€éš±ç§ä¿è­·èˆ‡å…¬é–‹é™åˆ¶</b><br>
          æ‰€æœ‰èªéŸ³ã€æ–‡å­—ã€åœ–ç‰‡å…§å®¹çš†å±¬ç§äººäº’å‹•â€¦<br>
          <b>ğŸš« ä¸ƒã€å„ªæƒ èˆ‡é»‘åå–®è¦å‰‡</b><br>
          å„ªæƒ åˆ¸èˆ‡æ´»å‹•ä¸å¾—é‡è¤‡ä½¿ç”¨â€¦<br>
          <b>ğŸŒ¸ å…«ã€æº«æŸ”çµèª</b><br>
          æˆ‘æ˜¯ Ruï¼Œè‡´åŠ›æ–¼æ‰“é€ ä¸€å€‹æº«æŸ”ã€å®‰å…¨ã€ç•Œç·šæ¸…æ¥šçš„é™ªä¼´ç©ºé–“â€¦<br>
          <br>
          <b style="color:#c22;">ğŸ“Œ âŸªä¸‹å–®å³è¡¨ç¤ºæ‚¨å·²é–±è®€ä¸¦å®Œå…¨åŒæ„ä¸Šè¿°æ‰€æœ‰æœå‹™æ¢æ¬¾ï¼Œé•åè¦å‰‡æ•ä¸é€€æ¬¾ä¹Ÿä¸å†æä¾›æœå‹™âŸ«</b>
        </div>
        <label class="agree-label"><input type="checkbox" id="agreeRule" required> æˆ‘å·²è©³ç´°é–±è®€ä¸¦åŒæ„ä¸Šè¿°ã€ŠRu çš„é™ªç©æ³¨æ„äº‹é …èˆ‡æœå‹™è¦å‰‡ã€‹ï¼ˆå¿…é ˆå‹¾é¸ï¼‰</label>
      </div>
      <div class="form-section" style="text-align:center;">
        <button type="button" onclick="calcAll()">è¨ˆç®—æ‡‰ä»˜é‡‘é¡</button>
        <button type="submit" class="btn">å®Œæˆé ç´„ä¸¦é€å‡º</button>
      </div>
    </form>

    <!-- è¨‚å–®ç¸½è¦½ -->
    <div class="order-summary" id="summaryBox">
      <b>é ç´„æ™‚é–“ï¼š</b><span id="showTime"></span><br>
      <b>æ‰€é¸é …ç›®ï¼š</b><span id="showItems"></span><br>
      <b>æœå‹™é‡‘é¡å°è¨ˆï¼š</b><span id="subtotalTxt">0</span> å…ƒ<br>
      <b>æŠ˜æ‰£é‡‘é¡ï¼š</b><span id="discountTxt">0</span> å…ƒ<br>
      <b>è´ŠåŠ©é‡‘é¡ï¼š</b><span id="donateTxt">0</span> å…ƒ<br>
      <b>æœ€çµ‚æ‡‰ä»˜é‡‘é¡ï¼š</b><span id="total">0</span> å…ƒ
    </div>

    <!-- è²·äº”é€äºŒè‡ªå‹•é¡¯ç¤º -->
    <div class="order-summary" id="bonusSection" style="background:#fffbe0; display:none;">
      ğŸ è²·äº”é€äºŒå„ªæƒ å·²å•Ÿå‹•ï¼è«‹é¸æ“‡å…©é …è¦è´ˆé€çš„æœå‹™ï¼š
      <select id="bonus1">
        <option value="">è«‹é¸æ“‡è´ˆé€é …ç›®</option>
        <option value="s1">å‚³èªªå°æ±º</option>
        <option value="s2">èªéŸ³é€šè©±</option>
        <option value="s3">æ‰“å­—èŠå¤©</option>
        <option value="s4">å…¨æ°‘Party å”±æ­Œ</option>
        <option value="s5">æƒ…æ„Ÿè«®è©¢</option>
      </select>
      <select id="bonus2">
        <option value="">è«‹é¸æ“‡è´ˆé€é …ç›®</option>
        <option value="s1">å‚³èªªå°æ±º</option>
        <option value="s2">èªéŸ³é€šè©±</option>
        <option value="s3">æ‰“å­—èŠå¤©</option>
        <option value="s4">å…¨æ°‘Party å”±æ­Œ</option>
        <option value="s5">æƒ…æ„Ÿè«®è©¢</option>
      </select>
    </div>

    <!-- LINE QR code -->
    <img src="ru-line-qr-demo.png" class="qr" alt="Line QR Code">
    <div class="footer">
      åŠ æˆ‘å®˜æ–¹ LINE è¯ç¹«å–”ï¼
    </div>
  </div>

  <!-- JS åŠŸèƒ½å€ -->
  <script>
    // ===== æ™‚é–“è¡¨è¨­å®š =====
    const timetable = {
      "2": ["00:00","00:30","01:00","01:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"],
      "3": ["23:00","23:30","00:00","00:30","01:00","01:30"],
      "4": ["19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30","00:00","00:30"],
      "5": ["23:00","23:30","00:00","00:30"],
      "6": ["19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30","00:00","00:30","01:00","01:30"],
      "7": [
        "00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30",
        "04:00","04:30","05:00","05:30","06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30",
        "10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30",
        "16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"
      ]
    };
    function updateTimeblocks() {
      const day = document.getElementById('weekday').value;
      const blockSel = document.getElementById('timeblock');
      blockSel.innerHTML = '<option value="">è«‹é¸æ“‡æ™‚é–“</option>';
      if (!timetable[day]) return;
      timetable[day].forEach(time => {
        let opt = document.createElement('option');
        opt.value = time;
        opt.innerText = time;
        blockSel.appendChild(opt);
      });
    }
    document.getElementById('weekday').addEventListener('change', updateTimeblocks);

    // ====== æŠ˜æ‰£é‡‘æˆªåœ–ä¸Šå‚³åˆ‡æ› ======
    function toggleDiscountProof() {
      const discount = document.getElementById('discount').value;
      const proof = document.getElementById('discountProof');
      const label = document.getElementById('discountProofLabel');
      if (discount === "0") {
        proof.style.display = "none";
        label.style.display = "none";
      } else {
        proof.style.display = "block";
        label.style.display = "block";
      }
    }

    // ====== ä»˜æ¬¾æ–¹å¼äº’å‹• ======
    function onPayTypeChange() {
      const payType = document.getElementById('payType').value;
      document.getElementById('bankInfo').style.display = (payType==="bank") ? "" : "none";
      document.getElementById('payRemark').style.display = (payType==="linepay") ? "" : "none";
    }

    // ====== è¨ˆç®—é‡‘é¡é‚è¼¯ ======
    function calcAll() {
      let price = [200,250,200,100,200];
      let items = [];
      let subtotal = 0;
      let singles = 0;
      for(let i=1;i<=5;i++){
        let v = parseInt(document.getElementById('s'+i).value)||0;
        if(v>0){
          items.push(['å‚³èªªå°æ±º','èªéŸ³é€šè©±','æ‰“å­—èŠå¤©','å…¨æ°‘Party å”±æ­Œ','æƒ…æ„Ÿè«®è©¢'][i-1]+' x'+v);
          subtotal += v*price[i-1];
          singles += v;
        }
      }
      document.getElementById('showItems').innerText = items.join('ã€')||'ç„¡';
      document.getElementById('subtotalTxt').innerText = subtotal;
      let discount = parseInt(document.getElementById('discount').value)||0;
      document.getElementById('discountTxt').innerText = discount;
      let donate = document.getElementById('donateCheck').checked ? (parseInt(document.getElementById('donateAmt').value)||0) : 0;
      document.getElementById('donateTxt').innerText = donate;
      let total = subtotal - discount + donate;
      document.getElementById('total').innerText = total<0?0:total;
      document.getElementById('showTime').innerText =
        (getWeekdayStr(document.getElementById('weekday').value) || '') +
        (document.getElementById('timeblock').value ? ' ' + document.getElementById('timeblock').value : '');
      // è²·äº”é€äºŒé‚è¼¯
      let bonus = document.getElementById('bonusSection');
      let bonusCount = Math.floor(singles / 5) * 2;
      if (bonusCount > 0) {
        bonus.style.display = '';
        // å‹•æ…‹é¡¯ç¤ºå¤šå€‹è´ˆé€ä¸‹æ‹‰é¸å–®
        let selectHTML = '';
        for (let i = 1; i <= bonusCount; i++) {
          selectHTML +=
            `<select id="bonus${i}" style="margin-right:7px;margin-top:5px;">
              <option value="">è«‹é¸æ“‡è´ˆé€é …ç›®</option>
              <option value="s1">å‚³èªªå°æ±º</option>
              <option value="s2">èªéŸ³é€šè©±</option>
              <option value="s3">æ‰“å­—èŠå¤©</option>
              <option value="s4">å…¨æ°‘Party å”±æ­Œ</option>
              <option value="s5">æƒ…æ„Ÿè«®è©¢</option>
            </select>`;
        }
        bonus.innerHTML =
          `ğŸ å·²é”è²·${Math.floor(singles/5)*5}é€${bonusCount}å„ªæƒ ï¼è«‹é¸æ“‡è´ˆé€çš„æœå‹™ï¼š<br>${selectHTML}`;
      } else {
        bonus.style.display = 'none';
      }
    }
    function getWeekdayStr(num) {
      switch(num) {
        case '2': return 'æ˜ŸæœŸäºŒ'; case '3': return 'æ˜ŸæœŸä¸‰'; case '4': return 'æ˜ŸæœŸå››'; case '5': return 'æ˜ŸæœŸäº”'; case '6': return 'æ˜ŸæœŸå…­'; case '7': return 'æ˜ŸæœŸæ—¥';
        default: return '';
      }
    }

    // ====== è¡¨å–®é€å‡º ======
    document.getElementById("orderForm").onsubmit = function(event){
      event.preventDefault();
      if (!document.getElementById("agreeRule").checked) {
        alert("è«‹å‹¾é¸åŒæ„æœå‹™è¦å‰‡ï¼");
        return;
      }
      let singles = 0;
      for(let i=1;i<=5;i++){
        singles += parseInt(document.getElementById('s'+i).value)||0;
      }
      // collect bonus selected values
      let bonusVals = [];
      let bonusCount = Math.floor(singles / 5) * 2;
      for (let i = 1; i <= bonusCount; i++) {
        let sel = document.getElementById(`bonus${i}`);
        if (sel && sel.value) bonusVals.push(sel.value);
      }
      let formData = {
        nickname: document.getElementById('nickname').value,
        payType: document.getElementById('payType').value,
        time: getWeekdayStr(document.getElementById('weekday').value) + ' ' + document.getElementById('timeblock').value,
        items: document.getElementById('showItems').innerText,
        subtotal: document.getElementById('subtotalTxt').innerText,
        discount: document.getElementById('discountTxt').innerText,
        donate: document.getElementById('donateTxt').innerText,
        bonus: bonusVals.join(','),
      };
      fetch("ã€https://script.google.com/macros/s/AKfycbymrXfRiiNVtpFjBVX5ZoEVOWUfMamLKN96zm9B_JCXloLE2vpX7vIoKwukiF4kAk0l/execã€‘", {
        method: "POST",
        body: JSON.stringify(formData),
        headers: { "Content-Type": "application/json" }
      }).then(r=>r.text()).then(res=>{
        alert('é ç´„å·²é€å‡ºï¼');
      }).catch(e=>{
        alert('é€å‡ºå¤±æ•—ï¼Œè«‹è¯çµ¡Ruï¼');
      });
    };

    // åˆå§‹åŒ–
    window.onload = function(){
      Array.from(document.querySelectorAll('input,select')).forEach(function(e){
        e.addEventListener('change', calcAll);
        e.addEventListener('input', calcAll);
      });
      calcAll();
      updateTimeblocks();
    }
  </script>
</body>
</html>
